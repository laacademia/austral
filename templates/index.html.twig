{# templates/index.html.twig #}

{% extends 'base.html.twig' %}

{% block javascripts %}
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>

    <script src="https://js.pusher.com/5.1/pusher.min.js"></script>
    <script src="./js/wheatherstack/index.js"></script>
    <script>
        //hago que se renderize cada 1 minuto
        setInterval($('#wheater').WeatherStack(),1000);        
        

        Pusher.logToConsole = true;

        var pusher = new Pusher("{{ pusherKey }}", {
            cluster: "{{ pusherCluster }}",
        });

        var channel = pusher.subscribe('turnos-channel');

        channel.bind('actualizar', function(data) {  
            console.log(data);
            document.getElementById('total_personas').textContent = data[0].total_personas;
            document.getElementById('total_atendidos').textContent = data[0].total_atendidos;
            document.getElementById('total_no_atendidos').textContent = data[0].total_no_atendidos;
        });

    </script>


{% endblock %}

{% block body %}
    
    <div class="barra-superior">
        <div class="block-barra-superior">
            <div id="titulo">Sistema de Turnos</div>
            <div id="wheater"></div> 
        </div>        
    </div>

    <div class="container">   

        <div class="row justify-content-md-center">
            <div class="col-sm" align="center">
                <div class="contador" alt="Cantidad de personas que solicitaron un turno">                
                    <div class="numero-contador"><p align="center" id="total_personas">{{ total_personas }}</p></div>
                    <p class="texto-contador" align="center">Total</p>
                </div>
            </div>
            <div class="col-sm" align="center">
                <div class="contador" alt="Cantidad Atendidos">
                    <p class="numero-contador" align="center" id="total_atendidos">{{ total_atendidos }}</p>
                    <p class="texto-contador" align="center">Atendidos</p>
                    
                </div>    
            </div>
            <div class="col-sm" align="center">
                <div class="contador" alt="Cantidad no atendidos">
                    <p class="numero-contador" align="center" id="total_no_atendidos">{{ total_no_atendidos }}</p>
                    <p class="texto-contador" align="center">Faltantes</p>
                    
                </div>      
            </div>
        </div>

    </div>

{% endblock %}


{% block stylesheets %}
<link rel="stylesheet" href="./css/weatherstack/main.css" >

<style>
p{
    margin:0;
    padding: 0;
}

#titulo{
    margin: 0;
    color:white;
    font-size:30px;
    float: left;
}
#wheater{
    float: right;
}
.container-fluid{
    margin: 0;
    padding: 0;
}
.barra-superior{
    height:20vh;
    background-color: #406f99;
    opacity: .9;
    margin-bottom: 2vh;
}   

.contador{
    width:30vh;
    height: 30vh;
    /*line-height: 35vh;*/
    border-radius: 50%;
    background-color: #333;
    opacity: .9;
    color: #fff;
    -webkit-box-shadow: 3px 3px 3px 1px rgba(0,0,0,0.91);
    -moz-box-shadow: 3px 3px 3px 1px rgba(0,0,0,0.91);
    box-shadow: 3px 3px 3px 1px rgba(0,0,0,0.91);
    
}
.numero-contador{
    text-align: center;
    font-size: 20vh;
    line-height: 30vh;
    font-weight: bold;
    text-shadow: 1px 1px 1px rgba(0, 0, 0, 1);
    
}
.texto-contador{
    text-align: center;
    font-size: 40px;
    font-weight: bold;
    text-shadow: 1px 1px 1px rgba(0, 0, 0, 1);
    
    opacity: 1;
    color: #000;
}

@media only screen and (max-width: 600px) {

    #login_container{
        text-align: center;
        margin: auto;
        background-color:
        aliceblue;
        padding: 1vw;
    }
}
</style>
{% endblock %}